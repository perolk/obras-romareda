<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obras Romareda | Seguimiento Oficial</title>

    <!-- ✅ MEJORA MEDIA: Meta tags Open Graph para previsualización en redes sociales -->
    <meta name="description" content="Sigue el proceso de construcción de la nueva Romareda semana a semana. Vídeos, fotos y estado de las obras en tiempo real.">
    <meta property="og:title" content="Obras Romareda | Seguimiento Oficial">
    <meta property="og:description" content="Sigue el proceso de construcción de la nueva Romareda semana a semana. Vídeos, fotos y estado de las obras en tiempo real.">
    <meta property="og:image" content="https://nuevaromareda.es/wp-content/uploads/2024/10/home-nueva-romareda-01-3.png">
    <meta property="og:url" content="https://obrasromareda.es">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ObrasRomareda">
    <meta name="twitter:title" content="Obras Romareda | Seguimiento Oficial">
    <meta name="twitter:description" content="Sigue el proceso de construcción de la nueva Romareda semana a semana.">
    <meta name="twitter:image" content="https://nuevaromareda.es/wp-content/uploads/2024/10/home-nueva-romareda-01-3.png">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <style>
        /* --- VARIABLES Y COLORES --- */
        :root {
            --zaragoza-blue: #00529F;
            --zaragoza-light: #4DA9FF;
            --text-dark: #1a1a1a;
            --text-muted: #6b7280;
            --bg-light: #f9fafb;
            --card-glass: rgba(255, 255, 255, 0.85);
            --border-color: rgba(0, 82, 159, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-dark);
            overflow-x: hidden;
            background-color: var(--bg-light); 
            min-height: 100vh;
            line-height: 1.6;
        }

        h1, h2, h3, h4, h5 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            color: var(--zaragoza-blue);
            line-height: 1.2;
        }

        /* --- HEADER --- */
        header {
            background: var(--zaragoza-blue);
            padding: 1rem 5%;
            position: fixed;
            width: 100%;
            z-index: 1000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .logo {
            font-family: 'Calibri', 'Segoe UI', sans-serif;
            font-weight: 700;
            font-style: italic;
            font-size: 1.8rem;
            color: white;
            text-decoration: none;
            transition: 0.3s;
        }
        .logo:hover { color: var(--zaragoza-light); }

        nav ul { display: flex; gap: 2.5rem; list-style: none; }
        nav a {
            color: white;
            text-decoration: none;
            font-weight: 500;
            font-size: 1rem;
            position: relative;
            transition: color 0.3s;
        }
        nav a:hover { color: var(--zaragoza-light); }

        .social-header a {
            margin-left: 1.5rem;
            color: white;
            font-size: 1.3rem;
            transition: color 0.3s, transform 0.3s;
        }
        .social-header a:hover { transform: translateY(-3px); color: var(--zaragoza-light); }

        /* ✅ MEJORA ALTA: Botón hamburguesa - oculto por defecto en escritorio */
        .hamburger {
            display: none;
            flex-direction: column;
            gap: 5px;
            cursor: pointer;
            padding: 5px;
            background: none;
            border: none;
            z-index: 1100;
        }
        .hamburger span {
            display: block;
            width: 25px;
            height: 3px;
            background: white;
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        /* Animación del hamburguesa → X */
        .hamburger.open span:nth-child(1) { transform: translateY(8px) rotate(45deg); }
        .hamburger.open span:nth-child(2) { opacity: 0; }
        .hamburger.open span:nth-child(3) { transform: translateY(-8px) rotate(-45deg); }

        /* --- HERO SECTION --- */
        .hero {
            height: 100vh;
            background: linear-gradient(rgba(0, 82, 159, 0.75), rgba(0, 0, 0, 0.7)), url('https://nuevaromareda.es/wp-content/uploads/2024/10/home-nueva-romareda-01-3.png');
            background-size: cover;
            background-position: center;
            background-attachment: scroll;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 0 20px;
            color: white;
        }

        .hero h1 {
            font-size: 4.5rem;
            margin-bottom: 1rem;
            text-shadow: 0 6px 20px rgba(0,0,0,0.4);
            letter-spacing: -1px;
            color: white;
        }

        .construction-counter {
            background: rgba(0, 82, 159, 0.6);
            backdrop-filter: blur(8px);
            padding: 8px 25px;
            border-radius: 50px;
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            font-size: 1.1rem;
            margin-bottom: 0;
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .construction-counter span {
            font-weight: 900;
            color: var(--zaragoza-light);
            font-size: 1.3rem;
            margin-right: 5px;
        }

        .hero p {
            font-size: 1.6rem;
            color: white;
            max-width: 900px;
            margin-top: 40px;
            margin-bottom: 60px;
            font-weight: 300;
        }

        .cta-btn {
            padding: 16px 45px;
            background: white;
            color: var(--zaragoza-blue);
            text-decoration: none;
            font-weight: 700;
            border-radius: 50px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            transition: transform 0.3s ease-in-out;
            font-size: 1.1rem;
        }
        .cta-btn:hover { transform: translateY(-5px) scale(1.02); }

        /* --- SECTIONS GENERAL --- */
        section { padding: 6rem 10%; }

        #videos { background: var(--zaragoza-blue); color: white; }
        #videos .section-title, #videos h3 { color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        #videos .section-title::after { background: var(--zaragoza-light); }

        .section-title {
            font-size: 3rem;
            margin-bottom: 4rem;
            color: white;
            font-weight: 900;
            text-align: center;
            position: relative;
        }
        .section-title::after {
            content: '';
            position: absolute;
            left: 50%; bottom: -15px; transform: translateX(-50%);
            width: 80px; height: 4px;
            background: var(--zaragoza-light);
            border-radius: 2px;
        }

        #fases .section-title, #comparador .section-title, #proyecto .section-title, #historia .section-title { color: var(--zaragoza-blue); text-shadow: none; }
        #fases .section-title::after, #comparador .section-title::after, #proyecto .section-title::after, #historia .section-title::after { background: var(--zaragoza-blue); }

        /* --- LAYOUT GRID --- */
        .updates-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
            align-items: start;
        }

        /* --- VIDEOS --- */
        .weekly-videos { display: flex; flex-direction: column; height: 100%; }
        .weekly-videos h3 { font-size: 1.5rem; margin-bottom: 25px; margin-top: 0; }

        .featured-video-card {
            background: var(--card-glass);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.2);
            max-width: 100%;
            margin: 0;
        }
        .video-thumb-large { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; }
        .video-thumb-large iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .featured-info { padding: 25px; }
        .featured-info h4 { font-size: 1.5rem; margin-bottom: 10px; color: var(--zaragoza-blue); }
        .featured-info p { font-size: 1rem; color: var(--text-muted); }

        /* ✅ MEJORA ALTA: Lazy Loading de vídeos - Thumbnail clicable en lugar de iframe */
        .scroll-label {
            font-size: 1.1rem; color: white; margin-bottom: 15px; font-weight: 500; display: flex; align-items: center; gap: 10px; margin-top: 30px; 
        }
        .scroll-label i { color: var(--zaragoza-light); }

        .video-scroll-container {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; padding-top: 10px; box-sizing: border-box; 
        }

        .mini-video-card {
            width: 100%; background: var(--card-glass); border-radius: 15px; overflow: hidden; box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: transform 0.3s; display: flex; flex-direction: column;
        }
        .mini-video-card:hover { transform: translateY(-5px); }

        /* Thumbnail lazy: reemplaza el iframe hasta que el usuario hace clic */
        .mini-thumb {
            position: relative;
            padding-bottom: 56.25%;
            height: 0;
            overflow: hidden;
            cursor: pointer;
            background: #000;
        }
        .mini-thumb .yt-thumbnail {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            object-fit: cover;
            transition: opacity 0.3s;
        }
        .mini-thumb .play-btn {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 54px; height: 54px;
            background: rgba(0,0,0,0.75);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            transition: background 0.3s, transform 0.3s;
        }
        .mini-thumb .play-btn i {
            color: white;
            font-size: 1.4rem;
            margin-left: 4px; /* centra visualmente el triángulo */
        }
        .mini-thumb:hover .play-btn {
            background: var(--zaragoza-blue);
            transform: translate(-50%, -50%) scale(1.1);
        }
        .mini-thumb iframe {
            position: absolute; top: 0; left: 0;
            width: 100%; height: 100%;
            border: none;
        }

        .mini-info { padding: 15px; flex-grow: 1; }
        .mini-info h5 { font-size: 1rem; color: var(--zaragoza-blue); margin-bottom: 5px; line-height: 1.3; height: 3em; overflow: hidden;}
        .mini-info span.date { font-size: 0.8rem; color: var(--text-muted); }
        .week-badge {
            display: block; font-size: 0.8rem; font-weight: 800; color: var(--zaragoza-light); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px;
        }

        /* --- ÁLBUMES SEMANALES --- */
        .daily-summary { display: flex; flex-direction: column; }
        .albums-header { margin-bottom: 25px; }
        .albums-header h3 { font-size: 1.5rem; margin-top: 0; margin-bottom: 0; }

        .album-card {
            background: var(--card-glass);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            cursor: pointer;
            transition: transform 0.3s;
            position: relative;
            border: 1px solid rgba(255,255,255,0.2);
            display: block;
        }
        .album-card:hover { transform: translateY(-5px); }
        
        .album-cover-img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }
        .album-overlay {
            padding: 15px;
            background: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .album-title {
            font-weight: 700;
            color: var(--zaragoza-blue);
            font-size: 1.1rem;
        }
        .album-count {
            font-size: 0.85rem;
            color: var(--text-muted);
            background: #f0f0f0;
            padding: 4px 10px;
            border-radius: 20px;
        }

        .load-more-btn {
            width: 100%;
            padding: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid white;
            color: white;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
        }
        .load-more-btn:hover { background: white; color: var(--zaragoza-blue); }

        /* --- ESTILOS FASES DE OBRA --- */
        .phases-container {
            display: flex; justify-content: center; align-items: flex-start; max-width: 1000px; margin: 40px auto 0; position: relative;
        }
        .phase-item {
            display: flex; flex-direction: column; align-items: center; text-align: center; width: 150px; position: relative; z-index: 2;
        }
        .phase-circle {
            width: 50px; height: 50px; border-radius: 50%; background: #e0e0e0; color: #666; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 1.2rem; margin-bottom: 15px; border: 4px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.3s;
        }
        .phase-content h4 { color: var(--text-dark); margin-bottom: 5px; font-size: 1rem; }
        .phase-content span { font-size: 0.8rem; color: var(--text-muted); display: block; }
        
        .phase-item.completed .phase-circle { background: var(--zaragoza-blue); color: white; }
        .phase-item.active .phase-circle { background: white; border-color: var(--zaragoza-blue); color: var(--zaragoza-blue); transform: scale(1.2); box-shadow: 0 0 0 4px rgba(0, 82, 159, 0.2); }
        .phase-item.active h4 { color: var(--zaragoza-blue); font-weight: 900; }
        
        .status-badge {
            background: var(--zaragoza-light); color: white; font-size: 0.7rem; padding: 2px 8px; border-radius: 10px; margin-top: 5px; display: inline-block; text-transform: uppercase; font-weight: bold;
        }
        .phase-line {
            flex-grow: 1; height: 4px; background: #e0e0e0; margin-top: 23px; position: relative; z-index: 1;
        }
        .phase-line.completed { background: var(--zaragoza-blue); }

        /* --- ESTILOS COMPARADOR --- */
        .comparison-wrapper {
            position: relative; width: 100%; max-width: 900px; margin: 0 auto; border-radius: 15px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .img-comp-container { position: relative; height: 500px; overflow: hidden; }
        .img-comp-img { position: absolute; width: auto; height: 100%; overflow: hidden; }
        .img-comp-img img { display: block; height: 100%; width: auto; }
        .img-comp-slider {
            position: absolute; z-index: 9; cursor: ew-resize; width: 40px; height: 40px; background-color: var(--zaragoza-light); border: 3px solid white; opacity: 1; border-radius: 50%; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; align-items: center; justify-content: center; box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        .img-comp-slider::before { content: '\f337'; font-family: "Font Awesome 6 Free"; font-weight: 900; color: white; }
        .img-comp-overlay-label { position: absolute; bottom: 20px; background: rgba(0,0,0,0.5); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.9rem; pointer-events: none; }

        /* --- PROYECTO & HISTORIA --- */
        .project-gallery, .history-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; display: none; justify-content: center; justify-items: center; 
        }
        #renders, .history-grid { display: grid; }

        .project-item, .history-grid img {
            background: var(--bg-light); padding: 15px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.05);
            display: flex; flex-direction: column; align-items: center; text-align: center;
            width: 100%; max-width: 380px; 
        }
        .project-item img, .history-grid img { width: 100%; height: 250px; object-fit: cover; border-radius: 10px; }
        .history-grid img { cursor: pointer; transition: transform 0.3s, filter 0.3s; }
        .history-grid img:hover { transform: scale(1.03); filter: brightness(0.8); }
        .caption { margin-top: 10px; color: var(--zaragoza-blue); font-weight: 700; font-size: 0.9rem;}

        .tab-button {
            background: transparent; border: 2px solid var(--zaragoza-blue); color: var(--zaragoza-blue);
            font-size: 1rem; font-weight: 700; padding: 10px 30px; border-radius: 50px; cursor: pointer; transition: all 0.3s;
        }
        .tab-button:hover { background: rgba(0, 82, 159, 0.1); }
        .tab-button.active { background: var(--zaragoza-blue); color: white; }

        .history-timeline { max-width: 1000px; margin: 0 auto; padding-left: 40px; position: relative; }
        .history-timeline::before { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px; background: var(--zaragoza-blue); }
        .history-item::before { content: ''; position: absolute; left: -10px; top: 5px; width: 20px; height: 20px; background: white; border: 4px solid var(--zaragoza-blue); border-radius: 50%; }
        .history-item { text-align: center; }

        /* --- MODALES --- */
        #albumModal, #archiveModal, #imageModal {
            display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.95); backdrop-filter: blur(10px);
        }
        #imageModal { z-index: 3000; align-items: center; justify-content: center; flex-direction: column; background-color: rgba(0,0,0,0.98); }

        .album-modal-container {
            max-width: 900px; margin: 50px auto; padding: 20px;
        }
        .album-modal-header {
            display: flex; justify-content: space-between; align-items: center; color: white; margin-bottom: 30px; border-bottom: 1px solid #333; padding-bottom: 20px;
        }
        .album-grid-content {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px;
        }
        .album-photo-card {
            background: #1a1a1a; border-radius: 10px; overflow: hidden; cursor: pointer; transition: transform 0.3s;
        }
        .album-photo-card:hover { transform: scale(1.03); border: 2px solid var(--zaragoza-light); }
        .album-photo-card img {
            width: 100%; height: 200px; object-fit: cover; display: block;
        }
        .album-photo-desc {
            padding: 15px; color: #ccc; font-size: 0.9rem; text-align: center;
        }

        .modal-content {
            margin: auto; display: block; max-width: 80%; max-height: 80vh; object-fit: contain; border-radius: 5px; animation-name: zoom; animation-duration: 0.3s;
        }
        #caption {
            margin: auto; display: block; width: 80%; max-width: 700px; text-align: center; color: #ccc; padding: 10px 0; height: auto; font-size: 1.2rem; font-weight: 500;
        }
        .close {
            position: absolute; top: 20px; right: 30px; color: #f1f1f1; font-size: 40px; font-weight: bold; transition: 0.3s; cursor: pointer; z-index: 3001;
        }
        .close:hover { color: var(--zaragoza-light); }

        .prev, .next {
            cursor: pointer; position: absolute; top: 50%; width: auto; padding: 16px; margin-top: -50px; color: white; font-weight: bold; font-size: 30px; transition: 0.6s ease; border-radius: 0 3px 3px 0; user-select: none; -webkit-user-select: none; z-index: 3001;
        }
        .next { right: 0; border-radius: 3px 0 0 3px; }
        .prev { left: 0; border-radius: 3px 0 0 3px; }
        .prev:hover, .next:hover { background-color: rgba(0, 0, 0, 0.8); color: var(--zaragoza-light); }

        @keyframes zoom { from {transform:scale(0)} to {transform:scale(1)} }

        /* --- FOOTER --- */
        footer { background: var(--zaragoza-blue); color: white; padding: 4rem 10%; text-align: center; border-top: 8px solid var(--zaragoza-light); }
        .footer-links { display: flex; justify-content: center; gap: 2rem; margin-bottom: 20px; }
        .footer-links a { color: white; font-size: 1.5rem; }

        /* ✅ MEJORA ALTA: RESPONSIVE MEJORADO con menú hamburguesa */
        @media (max-width: 1024px) {
            .hero { background-attachment: scroll; }
            .updates-container { grid-template-columns: 1fr; align-items: flex-start; }
            .hero h1 { font-size: 3rem; }

            /* Header: solo logo + hamburger en móvil */
            header {
                flex-direction: row;  /* Mantener en fila, no columna */
                flex-wrap: nowrap;
                align-items: center;
                padding: 1rem 5%;
            }

            .hamburger { display: flex; }

            /* Nav: oculto por defecto, desplegable */
            nav {
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                background: var(--zaragoza-blue);
                padding: 0;
                max-height: 0;
                overflow: hidden;
                transition: max-height 0.4s ease, padding 0.3s;
                box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            }
            nav.open {
                max-height: 300px;
                padding: 1rem 0 1.5rem;
            }
            nav ul {
                flex-direction: column;
                align-items: center;
                gap: 0;
            }
            nav ul li {
                width: 100%;
                text-align: center;
            }
            nav a {
                display: block;
                padding: 12px 20px;
                font-size: 1.1rem;
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            nav ul li:last-child a { border-bottom: none; }

            /* Redes sociales: en el menú desplegable */
            .social-header {
                position: absolute;
                top: 100%;
                left: 0;
                width: 100%;
                /* Se mostrará dentro del nav como último elemento */
                display: none; /* ocultamos el original */
            }

            section { padding: 4rem 5%; }
            .video-scroll-container { grid-template-columns: 1fr; }
            .mini-video-card { max-width: 300px; margin: 0 auto; }
            .modal-content { width: 95%; }
            .history-timeline { padding-left: 25px; }
            .project-item, .history-grid img { max-width: 100%; flex-basis: 100%; }
            
            .phases-container { flex-direction: column; align-items: flex-start; padding-left: 20px; }
            .phase-item { flex-direction: row; width: 100%; margin-bottom: 30px; text-align: left; }
            .phase-circle { margin-bottom: 0; margin-right: 20px; }
            .phase-line { position: absolute; left: 43px; top: 50px; width: 4px; height: 100%; margin-top: 0; }
            .phase-item:last-child .phase-line { display: none; }
            .phases-container > .phase-line { display: none; } 
            .phase-item::after { content: ''; position: absolute; left: 23px; top: 50px; width: 4px; height: 40px; background: #e0e0e0; z-index: 1; }
            .phase-item:last-child::after { display: none; }
            .phase-item.completed::after { background: var(--zaragoza-blue); }

            .img-comp-container { height: 300px; }

            /* Redes sociales en móvil - dentro del nav */
            .mobile-social {
                display: flex !important;
                justify-content: center;
                gap: 2rem;
                padding: 15px 0 5px;
            }
            .mobile-social a {
                color: white;
                font-size: 1.4rem;
                transition: color 0.3s, transform 0.3s;
            }
            .mobile-social a:hover { color: var(--zaragoza-light); transform: translateY(-3px); }
        }

        @media (min-width: 1025px) {
            .mobile-social { display: none !important; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">@ObrasRomareda</div>

        <!-- ✅ MEJORA ALTA: Menú hamburguesa -->
        <button class="hamburger" id="hamburgerBtn" aria-label="Abrir menú de navegación" aria-expanded="false">
            <span></span>
            <span></span>
            <span></span>
        </button>

        <nav id="mainNav" aria-label="Navegación principal">
            <ul>
                <li><a href="#videos">Actualidad</a></li>
                <li><a href="#proyecto">El Proyecto</a></li>
                <li><a href="#historia">Historia</a></li>
            </ul>
            <!-- Redes sociales duplicadas en el menú móvil -->
            <div class="mobile-social" style="display:none;">
                <!-- ✅ MEJORA MEDIA: rel="noopener noreferrer" añadido -->
                <a href="https://twitter.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Twitter de ObrasRomareda"><i class="fa-brands fa-x-twitter"></i></a>
                <a href="https://instagram.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Instagram de ObrasRomareda"><i class="fa-brands fa-instagram"></i></a>
                <a href="https://youtube.com/@ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="YouTube de ObrasRomareda"><i class="fa-brands fa-youtube"></i></a>
            </div>
        </nav>

        <!-- ✅ MEJORA MEDIA: rel="noopener noreferrer" añadido -->
        <div class="social-header">
            <a href="https://twitter.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Twitter de ObrasRomareda"><i class="fa-brands fa-x-twitter"></i></a>
            <a href="https://instagram.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Instagram de ObrasRomareda"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://youtube.com/@ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="YouTube de ObrasRomareda"><i class="fa-brands fa-youtube"></i></a>
        </div>
    </header>

    <section class="hero">
        <h1>El Futuro Comienza Hoy</h1>
        <div class="construction-counter">
            Día <span id="days-count">0</span> de obras
        </div>
        <p>Sigue el proceso de construcción de la nueva Romareda</p>
        <a href="#videos" class="cta-btn" aria-label="Ver los últimos avances de las obras">Ver Últimos Avances</a>
    </section>

    <section id="videos">
        <h2 class="section-title">Seguimiento Semanal & Diario</h2>
        
        <div class="updates-container">
            
            <div class="weekly-videos">
                <!-- Vídeo destacado: se rellena dinámicamente desde videos.json -->
                <div class="featured-content-wrapper">
                    <h3>Vídeo Destacado</h3>
                    <div id="featured-video-container">
                        <!-- Skeleton loader mientras carga -->
                        <div class="featured-video-card" id="featured-skeleton">
                            <div style="background:#1a3a5c; padding-bottom:56.25%; border-radius:20px 20px 0 0; display:flex; align-items:center; justify-content:center; position:relative;">
                                <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); color:rgba(255,255,255,0.3); font-size:3rem;">
                                    <i class="fas fa-spinner fa-spin"></i>
                                </div>
                            </div>
                            <div class="featured-info">
                                <div style="height:1.5rem; background:#e0e0e0; border-radius:4px; margin-bottom:10px; width:80%;"></div>
                                <div style="height:1rem; background:#e0e0e0; border-radius:4px; width:60%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Historial: se rellena dinámicamente desde videos.json -->
                <div>
                    <div class="scroll-label">
                        <i class="fas fa-history" aria-hidden="true"></i> Historial de Vídeos
                    </div>
                    <div class="video-scroll-container" id="history-video-container">
                        <!-- Skeletons de carga -->
                        <div class="mini-video-card" style="opacity:0.4;">
                            <div style="padding-bottom:56.25%; background:#1a3a5c; position:relative;"></div>
                            <div class="mini-info"><div style="height:1rem; background:#e0e0e0; border-radius:4px;"></div></div>
                        </div>
                        <div class="mini-video-card" style="opacity:0.4;">
                            <div style="padding-bottom:56.25%; background:#1a3a5c; position:relative;"></div>
                            <div class="mini-info"><div style="height:1rem; background:#e0e0e0; border-radius:4px;"></div></div>
                        </div>
                        <div class="mini-video-card" style="opacity:0.4;">
                            <div style="padding-bottom:56.25%; background:#1a3a5c; position:relative;"></div>
                            <div class="mini-info"><div style="height:1rem; background:#e0e0e0; border-radius:4px;"></div></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="daily-summary">
                <div class="albums-header">
                    <h3>Galería Semanal</h3>
                </div>

                <div id="sidebar-albums-container"></div>

                <button id="loadMoreBtn" class="load-more-btn" onclick="openArchiveModal()">Ver archivo completo</button>
            </div>
        </div>
    </section>

    <section id="fases" style="background: white; padding: 4rem 10%;">
        <h2 class="section-title" style="color: var(--zaragoza-blue); text-align: center;">Estado de la Obra</h2>
        
        <div class="phases-container">
            <div class="phase-item completed">
                <div class="phase-circle"><i class="fas fa-check" aria-hidden="true"></i></div>
                <div class="phase-content">
                    <h4>Demoliciones</h4>
                    <span>Julio 2024 - Oct 2024</span>
                </div>
            </div>
            <div class="phase-line completed"></div>

            <div class="phase-item active">
                <div class="phase-circle"><i class="fas fa-tools" aria-hidden="true"></i></div>
                <div class="phase-content">
                    <h4>Cimentación</h4>
                    <span>Nov 2024 - Feb 2025</span>
                    <div class="status-badge">En curso</div>
                </div>
            </div>
            <div class="phase-line"></div>

            <div class="phase-item">
                <div class="phase-circle">3</div>
                <div class="phase-content">
                    <h4>Estructura</h4>
                    <span>2025 - 2026</span>
                </div>
            </div>
            <div class="phase-line"></div>

            <div class="phase-item">
                <div class="phase-circle">4</div>
                <div class="phase-content">
                    <h4>Cubierta y Acabados</h4>
                    <span>2027</span>
                </div>
            </div>
        </div>
    </section>

    <section id="comparador" style="background: var(--bg-light); padding: 4rem 10%;">
        <h2 class="section-title" style="color: var(--zaragoza-blue); text-align: center;">El Cambio: Antes y Después</h2>
        
        <div class="comparison-wrapper">
            <div class="img-comp-container">
                <div class="img-comp-img">
                    <img src="https://www.idom.com/wp-content/uploads/2024/04/IDOM_Nueva-Romareda_render_interior_noche-1920x1080.jpg" width="900" height="500" alt="Render artístico de la nueva Romareda (IDOM)">
                    <div class="img-comp-overlay-label" style="right: 20px;">FUTURO (Render)</div>
                </div>
                <div class="img-comp-img img-comp-overlay">
                    <img src="https://www.heraldo.es/uploads/imagenes/2019/08/28/_P924010_f6390c26.jpg" width="900" height="500" alt="La Romareda antes de la demolición">
                    <div class="img-comp-overlay-label" style="left: 20px;">ANTES</div>
                </div>
            </div>
        </div>
    </section>

    <section id="proyecto">
        <h2 class="section-title">El Proyecto (IDOM)</h2>
        <p style="text-align: center; margin-bottom: 3rem; max-width: 800px; margin-left: auto; margin-right: auto;">
            Planos, renders y detalles técnicos de la futura casa del Real Zaragoza.
        </p>
        <div class="project-tabs" style="display:flex; justify-content:center; gap:20px; margin-bottom:30px;">
            <button class="tab-button active" onclick="openTab(event, 'renders')">Renders</button>
            <button class="tab-button" onclick="openTab(event, 'plantas')">Plantas y Alzados</button>
            <button class="tab-button" onclick="openTab(event, 'secciones')">Secciones</button>
        </div>

        <div id="renders" class="project-gallery tab-content">
            <div class="project-item">
                <img src="https://www.idom.com/wp-content/uploads/2024/04/IDOM_Nueva-Romareda_render_exterior_dia_plaza-1920x1080.jpg" alt="Render: Plaza Eduardo Ibarra">
                <div class="caption">Plaza Eduardo Ibarra</div>
            </div>
            <div class="project-item">
                <img src="https://www.idom.com/wp-content/uploads/2024/04/IDOM_Nueva-Romareda_render_interior_noche-1920x1080.jpg" alt="Render: Vista Interior Noche">
                <div class="caption">Vista Interior Noche</div>
            </div>
            <div class="project-item">
                <img src="https://pbs.twimg.com/media/GLIp4cAWkAAjB8S?format=jpg&name=large" alt="Render: Vista Aérea General">
                <div class="caption">Vista Aérea General</div>
            </div>
        </div>

        <div id="plantas" class="project-gallery tab-content">
            <div class="project-item">
                <img src="https://placehold.co/600x400/EEEEEE/00529F/png?text=Planta+General" alt="Planta General">
                <div class="caption">Planta General</div>
            </div>
            <div class="project-item">
                <img src="https://placehold.co/600x400/EEEEEE/00529F/png?text=Distribucion" alt="Distribución de Accesos">
                <div class="caption">Distribución de Accesos</div>
            </div>
        </div>

        <div id="secciones" class="project-gallery tab-content">
            <div class="project-item">
                <img src="https://placehold.co/600x400/EEEEEE/00529F/png?text=Seccion+Grada" alt="Sección Constructiva de Grada">
                <div class="caption">Sección Constructiva de Grada</div>
            </div>
        </div>
    </section>

    <section id="historia">
        <h2 class="section-title">Memoria Histórica</h2>
        <div class="history-timeline">
            <div class="history-item">
                <h3>Un Estadio de Leyenda (1957 - 2024)</h3>
                <p style="margin-bottom: 30px;">Más que hormigón, el corazón de Zaragoza. Haz clic en las imágenes para recordar.</p>
                
                <div class="history-grid">
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://statics-maker.llt-services.com/zar/images/2023/03/22/xlarge/89db9591-f362-4ba0-a080-0f445a8ef4a2.jpg" 
                             alt="Inauguración: 8 de Septiembre de 1957" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">1957: La Inauguración</p>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://as01.epimg.net/futbol/imagenes/2022/06/17/reportajes/1655460674_524206_1655460833_noticia_normal.jpg" 
                             alt="Sede del Mundial España '82" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">1982: Sede Mundialista</p>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://www.heraldo.es/uploads/imagenes/2015/05/08/_C7F9301_3a720520.jpg" 
                             alt="La Recopa en casa ante una Romareda llena" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">1995: La Recopa en Casa</p>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://www.heraldo.es/uploads/imagenes/2019/08/28/_P924010_f6390c26.jpg" 
                             alt="Concierto Michael Jackson History Tour 1996" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">1996: Michael Jackson</p>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://phantom-marca.unidadeditorial.es/f520297447740d32295799ce6cc50392/resize/828/f/jpg/assets/multimedia/imagenes/2023/02/08/16758536782412.jpg" 
                             alt="Noche mágica de Copa: 6-1 al Real Madrid" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">2006: Noche Mágica de Copa</p>
                    </div>
                    <div style="display: flex; flex-direction: column; align-items: center; width: 100%; max-width: 380px;">
                        <img src="https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg" 
                             alt="El último partido antes de la demolición" 
                             onclick="openModal(this.src, this.alt)">
                        <p class="caption" style="margin-top:8px; color:#6b7280;">2024: El Último Partido</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="imageModal" class="modal">
        <span class="close" onclick="closeModal()" aria-label="Cerrar imagen">&times;</span>
        <a class="prev" onclick="changeSlide(-1)" aria-label="Imagen anterior">&#10094;</a>
        <a class="next" onclick="changeSlide(1)" aria-label="Imagen siguiente">&#10095;</a>
        <img class="modal-content" id="img01" alt="">
        <div id="caption"></div>
    </div>

    <div id="albumModal">
        <div class="album-modal-container">
            <div class="album-modal-header">
                <h2 id="albumTitle" style="color:white; margin:0;">Título del Álbum</h2>
                <span class="close" onclick="closeAlbumModal()" style="position:relative; top:0; right:0; cursor:pointer;" aria-label="Cerrar álbum">&times;</span>
            </div>
            <div class="album-grid-content" id="albumContent"></div>
        </div>
    </div>

    <div id="archiveModal">
        <div class="album-modal-container">
            <div class="album-modal-header">
                <h2 style="color:white; margin:0;">Archivo Completo</h2>
                <span class="close" onclick="closeArchiveModal()" style="position:relative; top:0; right:0; cursor:pointer;" aria-label="Cerrar archivo">&times;</span>
            </div>
            <div class="album-grid-content" id="archiveGrid"></div>
        </div>
    </div>

    <footer>
        <div class="logo" style="margin-bottom: 20px; color:white;">@ObrasRomareda</div>
        <div class="footer-links">
            <!-- ✅ MEJORA MEDIA: rel="noopener noreferrer" en todos los enlaces externos -->
            <a href="https://twitter.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Twitter de ObrasRomareda"><i class="fa-brands fa-x-twitter"></i></a>
            <a href="https://instagram.com/ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="Instagram de ObrasRomareda"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://youtube.com/@ObrasRomareda" target="_blank" rel="noopener noreferrer" aria-label="YouTube de ObrasRomareda"><i class="fa-brands fa-youtube"></i></a>
        </div>
        <p>Web no oficial · Renders e imágenes técnicas: IDOM</p>
    </footer>

    <script>
        /* =========================================
           --- ÁREA DE CONFIGURACIÓN (SOLO EDITAS ESTO) ---
           ========================================= */
        
        // 1. CAMBIA ESTE NÚMERO CADA SEMANA AL ACTUAL
        const CURRENT_WEEK_NUM = 71; 

        // ✅ MEJORA MEDIA: Fecha de inicio centralizada aquí, fácil de editar
        // Formato: 'YYYY-MM-DD' - Fecha oficial de inicio de obras
        const OBRAS_START_DATE = '2024-07-08';

        // 2. AÑADE LOS DATOS DE LAS NUEVAS SEMANAS AQUÍ ARRIBA
        const explicitWeeks = {
            week71: {
                title: "Semana 71: Avance Estructural",
                photos: [
                    { src: "https://pbs.twimg.com/media/G6H7uWyWoAAVl2P?format=jpg&name=large", desc: "Hormigonado de vigas superiores" },
                    { src: "https://www.heraldo.es/uploads/imagenes/2024/07/08/_C7F9301_3a720520.jpg", desc: "Vista lateral de la nueva grada" },
                    { src: "https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg", desc: "Detalle de armaduras" },
                    { src: "https://phantom-marca.unidadeditorial.es/f520297447740d32295799ce6cc50392/resize/828/f/jpg/assets/multimedia/imagenes/2023/02/08/16758536782412.jpg", desc: "Panorámica al atardecer" }
                ]
            },
            week70: {
                title: "Semana 70: Montaje de Prefabricados",
                photos: [
                    { src: "https://www.heraldo.es/uploads/imagenes/2024/07/08/_C7F9301_3a720520.jpg", desc: "Colocación de gradas prefabricadas" },
                    { src: "https://pbs.twimg.com/media/G6H7uWyWoAAVl2P?format=jpg&name=large", desc: "Grúas en operación simultánea" },
                    { src: "https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg", desc: "Vista interior del bowl" }
                ]
            },
            week69: {
                title: "Semana 69: Instalaciones Eléctricas",
                photos: [
                    { src: "https://phantom-marca.unidadeditorial.es/f520297447740d32295799ce6cc50392/resize/828/f/jpg/assets/multimedia/imagenes/2023/02/08/16758536782412.jpg", desc: "Canalizaciones subterráneas" },
                    { src: "https://pbs.twimg.com/media/G6H7uWyWoAAVl2P?format=jpg&name=large", desc: "Avance en vomitorios" },
                    { src: "https://www.heraldo.es/uploads/imagenes/2024/07/08/_C7F9301_3a720520.jpg", desc: "Acopio de material de obra" },
                    { src: "https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg", desc: "Trabajos nocturnos" }
                ]
            },
            week68: {
                title: "Semana 68: Cierre de Esquinas",
                photos: [
                    { src: "https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg", desc: "Estructura de esquina suroeste" },
                    { src: "https://pbs.twimg.com/media/G6H7uWyWoAAVl2P?format=jpg&name=large", desc: "Encofrado de pilares" },
                    { src: "https://www.heraldo.es/uploads/imagenes/2024/07/08/_C7F9301_3a720520.jpg", desc: "Vista desde calle" },
                    { src: "https://phantom-marca.unidadeditorial.es/f520297447740d32295799ce6cc50392/resize/828/f/jpg/assets/multimedia/imagenes/2023/02/08/16758536782412.jpg", desc: "Panorámica general" }
                ]
            },
            week12: {
                title: "Semana 12: Izado de Estructuras",
                photos: [{ src: "https://pbs.twimg.com/media/G6H7uWyWoAAVl2P?format=jpg&name=large", desc: "Quinta grúa torre instalada" }]
            },
            week11: {
                title: "Semana 11: Cimentaciones",
                photos: [{ src: "https://www.heraldo.es/uploads/imagenes/2024/07/08/_C7F9301_3a720520.jpg", desc: "Hormigonado de zapatas" }]
            },
            week10: {
                title: "Semana 10: Demolición Finalizada",
                photos: [{ src: "https://phantom-marca.unidadeditorial.es/f520297447740d32295799ce6cc50392/resize/828/f/jpg/assets/multimedia/imagenes/2023/02/08/16758536782412.jpg", desc: "Gol Sur demolido" }]
            },
            week1: {
                title: "Semana 1: Inicio del Proyecto",
                photos: [{ src: "https://estaticos-cdn.prensaiberica.es/clip/bdc97986-08c6-4004-824b-0e60370f533d_16-9-aspect-ratio_default_0.jpg", desc: "Acto de primera piedra" }]
            }
        };

        /* =========================================
           --- FIN ÁREA CONFIGURACIÓN ---
           ========================================= */

        // --- GENERADOR DE DATOS ---
        const weeklyData = {};
        const placeholderImg = "https://placehold.co/600x400/1a1a1a/FFFFFF?text=Obras+Romareda";

        function getWeekData(weekNum) {
            const key = `week${weekNum}`;
            if (explicitWeeks[key]) return explicitWeeks[key];
            return {
                title: `Semana ${weekNum}: Avance de Obras`,
                photos: [{ src: placeholderImg, desc: `Vista general Semana ${weekNum}` }]
            };
        }

        for (let i = 1; i <= CURRENT_WEEK_NUM; i++) {
            weeklyData[`week${i}`] = getWeekData(i);
        }

        // --- VARIABLES GLOBALES ---
        let currentPhotos = [];
        let currentIndex = 0;

        // --- RENDERIZADO BARRA LATERAL ---
        function renderSidebar() {
            const container = document.getElementById('sidebar-albums-container');
            container.innerHTML = '';
            for (let i = CURRENT_WEEK_NUM; i > CURRENT_WEEK_NUM - 4 && i > 0; i--) {
                const weekId = `week${i}`;
                const data = weeklyData[weekId];
                const photoCount = data.photos.length;
                const card = document.createElement('div');
                card.className = 'album-card';
                card.onclick = function() { openAlbum(weekId); };
                card.innerHTML = `
                    <img src="${data.photos[0].src}" class="album-cover-img" alt="${data.title}">
                    <div class="album-overlay">
                        <div class="album-title">Semana ${i}</div>
                        <div class="album-count"><i class="fas fa-images" aria-hidden="true"></i> ${photoCount} Fotos</div>
                    </div>
                `;
                container.appendChild(card);
            }
        }

        function initArchive() {
            const grid = document.getElementById('archiveGrid');
            grid.innerHTML = '';
            const startArchive = CURRENT_WEEK_NUM - 4;
            for (let i = startArchive; i >= 1; i--) {
                const data = weeklyData[`week${i}`];
                const photo = data.photos[0];
                const card = document.createElement('div');
                card.className = 'album-photo-card';
                card.onclick = function() { openAlbum(`week${i}`); };
                card.innerHTML = `
                    <img src="${photo.src}" alt="${data.title}">
                    <div class="album-photo-desc" style="text-align: left;">
                        <div style="font-weight:bold; color:white;">Semana ${i}</div>
                        <div style="font-size:0.8rem;">${data.title.split(':')[1] || 'Progreso'}</div>
                    </div>
                `;
                grid.appendChild(card);
            }
        }

        // =========================================
        // CARGA DINÁMICA DE VÍDEOS DESDE videos.json
        // =========================================
        async function loadVideosFromJSON() {
            try {
                // Intenta cargar el JSON generado por la GitHub Action
                const res = await fetch('./videos.json');
                if (!res.ok) throw new Error('No encontrado');
                const data = await res.json();
                renderFeaturedVideo(data.featured);
                renderHistoryVideos(data.history);
            } catch (e) {
                // Si el JSON no existe (ej: desarrollo local), muestra mensaje amigable
                console.warn('videos.json no disponible, mostrando fallback.', e);
                renderFallback();
            }
        }

        function renderFeaturedVideo(video) {
            const container = document.getElementById('featured-video-container');
            if (!video) { container.innerHTML = '<p style="color:white;">No hay vídeo destacado.</p>'; return; }
            container.innerHTML = `
                <div class="featured-video-card">
                    <div class="video-thumb-large">
                        <iframe src="https://www.youtube.com/embed/${video.id}"
                                title="${video.title}"
                                allowfullscreen loading="lazy"></iframe>
                    </div>
                    <div class="featured-info">
                        <h4>${video.title}</h4>
                        <p>Publicado el ${video.date} · El último resumen semanal de las obras.</p>
                    </div>
                </div>`;
        }

        function renderHistoryVideos(videos) {
            const container = document.getElementById('history-video-container');
            if (!videos || videos.length === 0) { container.innerHTML = '<p style="color:white;">Sin vídeos en historial.</p>'; return; }
            container.innerHTML = videos.map(v => `
                <div class="mini-video-card">
                    <div class="mini-thumb"
                         data-videoid="${v.id}"
                         data-start="0"
                         onclick="loadVideo(this)"
                         role="button"
                         tabindex="0"
                         aria-label="Reproducir: ${v.title}">
                        <img class="yt-thumbnail"
                             src="${v.thumbnail}"
                             alt="Thumbnail: ${v.title}">
                        <div class="play-btn"><i class="fas fa-play" aria-hidden="true"></i></div>
                    </div>
                    <div class="mini-info">
                        <span class="week-badge">NUEVO</span>
                        <h5>${v.title}</h5>
                        <span class="date">${v.date}</span>
                    </div>
                </div>`).join('');
        }

        function renderFallback() {
            document.getElementById('featured-video-container').innerHTML = `
                <div class="featured-video-card">
                    <div style="padding:40px; text-align:center; color:var(--text-muted);">
                        <i class="fas fa-exclamation-circle" style="font-size:2rem; margin-bottom:10px; display:block;"></i>
                        <p>Los vídeos se cargarán automáticamente cuando la web esté publicada en GitHub Pages.</p>
                    </div>
                </div>`;
            document.getElementById('history-video-container').innerHTML = '';
        }

        // ✅ MEJORA ALTA: Lazy loading de vídeos - carga iframe solo al hacer clic
        function loadVideo(thumbEl) {
            const videoId = thumbEl.dataset.videoid;
            const start = thumbEl.dataset.start || '0';
            // Crear iframe en su lugar
            const iframe = document.createElement('iframe');
            iframe.src = `https://www.youtube.com/embed/${videoId}?start=${start}&autoplay=1`;
            iframe.title = 'YouTube video player';
            iframe.allowFullscreen = true;
            iframe.allow = 'autoplay; encrypted-media';
            iframe.style.cssText = 'position:absolute;top:0;left:0;width:100%;height:100%;border:none;';
            // Limpiar thumbnail y añadir iframe
            thumbEl.innerHTML = '';
            thumbEl.appendChild(iframe);
            thumbEl.onclick = null;
            thumbEl.style.cursor = 'default';
        }

        // Soporte teclado para thumbnails
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && document.activeElement.classList.contains('mini-thumb')) {
                loadVideo(document.activeElement);
            }
        });

        // --- LÓGICA COMPARADOR ---
        function initComparisons() {
            var x, i;
            x = document.getElementsByClassName("img-comp-overlay");
            for (i = 0; i < x.length; i++) {
                compareImages(x[i]);
            }
            function compareImages(img) {
                var slider, clicked = 0, w, h;
                w = img.offsetWidth;
                h = img.offsetHeight;
                img.style.width = (w / 2) + "px";
                slider = document.createElement("DIV");
                slider.setAttribute("class", "img-comp-slider");
                img.parentElement.insertBefore(slider, img);
                slider.style.top = (h / 2) - (slider.offsetHeight / 2) + "px";
                slider.style.left = (w / 2) - (slider.offsetWidth / 2) + "px";
                slider.addEventListener("mousedown", slideReady);
                window.addEventListener("mouseup", slideFinish);
                slider.addEventListener("touchstart", slideReady);
                window.addEventListener("touchend", slideFinish);
                function slideReady(e) {
                    e.preventDefault();
                    clicked = 1;
                    window.addEventListener("mousemove", slideMove);
                    window.addEventListener("touchmove", slideMove);
                }
                function slideFinish() { clicked = 0; }
                function slideMove(e) {
                    var pos;
                    if (clicked == 0) return false;
                    pos = getCursorPos(e);
                    if (pos < 0) pos = 0;
                    if (pos > w) pos = w;
                    slide(pos);
                }
                function getCursorPos(e) {
                    var a, x = 0;
                    e = (e.changedTouches) ? e.changedTouches[0] : e;
                    a = img.getBoundingClientRect();
                    x = e.pageX - a.left;
                    x = x - window.pageXOffset;
                    return x;
                }
                function slide(x) {
                    img.style.width = x + "px";
                    slider.style.left = img.offsetWidth - (slider.offsetWidth / 2) + "px";
                }
            }
        }

        // --- MODALES ---
        function openArchiveModal() {
            initArchive();
            document.getElementById('archiveModal').style.display = 'block';
        }
        function closeArchiveModal() {
            document.getElementById('archiveModal').style.display = 'none';
        }

        function openAlbum(weekId) {
            closeArchiveModal();
            const modal = document.getElementById('albumModal');
            const title = document.getElementById('albumTitle');
            const content = document.getElementById('albumContent');
            const data = weeklyData[weekId];
            if (data) {
                title.textContent = data.title;
                content.innerHTML = '';
                data.photos.forEach((photo, index) => {
                    const photoCard = document.createElement('div');
                    photoCard.className = 'album-photo-card';
                    photoCard.innerHTML = `
                        <img src="${photo.src}" alt="${photo.desc}" onclick="openGallerySlide('${weekId}', ${index})">
                        <div class="album-photo-desc">${photo.desc}</div>
                    `;
                    content.appendChild(photoCard);
                });
                modal.style.display = 'block';
            }
        }

        function closeAlbumModal() {
            document.getElementById('albumModal').style.display = 'none';
        }

        function openGallerySlide(weekId, index) {
            currentPhotos = weeklyData[weekId].photos;
            currentIndex = index;
            showSlide();
            document.getElementById('imageModal').style.display = "flex";
        }

        function openModal(src, alt) {
            currentPhotos = [{ src: src, desc: alt }];
            currentIndex = 0;
            showSlide();
            document.getElementById('imageModal').style.display = "flex";
        }

        function showSlide() {
            const img = document.getElementById('img01');
            const caption = document.getElementById('caption');
            const photo = currentPhotos[currentIndex];
            img.src = photo.src;
            img.alt = photo.desc;
            if (currentPhotos.length > 1) {
                caption.innerHTML = `${photo.desc} <br> <span style="font-size:0.8em; color:#999;">(${currentIndex + 1} / ${currentPhotos.length})</span>`;
                document.querySelector('.prev').style.display = "block";
                document.querySelector('.next').style.display = "block";
            } else {
                caption.innerHTML = photo.desc;
                document.querySelector('.prev').style.display = "none";
                document.querySelector('.next').style.display = "none";
            }
        }

        function changeSlide(n) {
            currentIndex += n;
            if (currentIndex >= currentPhotos.length) currentIndex = 0;
            if (currentIndex < 0) currentIndex = currentPhotos.length - 1;
            showSlide();
        }

        function closeModal() {
            document.getElementById("imageModal").style.display = "none";
        }

        document.addEventListener('keydown', function(event) {
            if (document.getElementById('imageModal').style.display === "flex") {
                if (event.key === "ArrowLeft") changeSlide(-1);
                if (event.key === "ArrowRight") changeSlide(1);
                if (event.key === "Escape") closeModal();
            }
            if (event.key === "Escape") {
                closeArchiveModal();
                closeAlbumModal();
            }
        });

        // ✅ MEJORA ALTA: Lógica del menú hamburguesa
        const hamburgerBtn = document.getElementById('hamburgerBtn');
        const mainNav = document.getElementById('mainNav');

        hamburgerBtn.addEventListener('click', function() {
            const isOpen = mainNav.classList.toggle('open');
            hamburgerBtn.classList.toggle('open', isOpen);
            hamburgerBtn.setAttribute('aria-expanded', isOpen);
        });

        // Cerrar el menú al hacer clic en un enlace
        mainNav.querySelectorAll('a[href^="#"]').forEach(link => {
            link.addEventListener('click', function() {
                mainNav.classList.remove('open');
                hamburgerBtn.classList.remove('open');
                hamburgerBtn.setAttribute('aria-expanded', 'false');
            });
        });

        // --- INICIALIZACIÓN ---
        document.addEventListener('DOMContentLoaded', function() {
            // ✅ MEJORA MEDIA: usa OBRAS_START_DATE de la zona de configuración
            const startDate = new Date(OBRAS_START_DATE + 'T00:00:00');
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const diffTime = Math.abs(today - startDate);
            const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
            document.getElementById('days-count').textContent = diffDays;

            renderSidebar();
            initComparisons();
            console.log('Iniciando carga de vídeos...');
loadVideosFromJSON().then(() => {
    console.log('Vídeos cargados OK');
}).catch(e => {
    console.error('Error cargando vídeos:', e);
});
        });

        function openTab(evt, tabName) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "flex";
            document.getElementById(tabName).style.justifyContent = "center";
            document.getElementById(tabName).style.justifyItems = "center";
            evt.currentTarget.className += " active";
        }

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) target.scrollIntoView({ behavior: 'smooth' });
            });
        });

        window.onclick = function(event) {
            if (event.target == document.getElementById('archiveModal')) closeArchiveModal();
            if (event.target == document.getElementById('albumModal')) closeAlbumModal();
            if (event.target == document.getElementById('imageModal')) closeModal();
        }
    </script>
</body>
</html>
